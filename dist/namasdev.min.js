/*!
 * namasdev JS
 *
 * @version 1.0.0
 * @author Matias Lopez - https://github.com/MatiasALopez
 * @link https://github.com/MatiasALopez/namasdev.Web.JS
 * @copyright 2024 Matias Lopez
 * @license Released under the MIT license.
 */
"use strict"; var nmd = function () { var t = { stringFormat: function (t, ...e) { if (!t) return t; for (var n = $.isArray(e[0]) ? e[0] : e, a = 0; a < n.length; a++)t = t.replace(new RegExp("\\{" + a + "\\}", "gm"), n[a]); return t }, repeatString: function (t, e) { for (var n = ""; e > 0;)n += t, e--; return n }, throttle: function (t, e, n) { var a, i, o, r = null, s = 0; n || (n = {}); var l = function () { s = !1 === n.leading ? 0 : Date.now(), r = null, o = t.apply(a, i), r || (a = i = null) }; return function () { var c = Date.now(); s || !1 !== n.leading || (s = c); var u = e - (c - s); return a = this, i = arguments, u <= 0 || u > e ? (r && (clearTimeout(r), r = null), s = c, o = t.apply(a, i), r || (a = i = null)) : r || !1 === n.trailing || (r = setTimeout(l, u)), o } }, round: function (t, e) { var n = Math.pow(10, e || 0); return Math.round(t * n) / n }, createDateTimeFromUnixTimestamp: function (t) { return new Date(parseInt(t.match(/\d+/g)[0])) } }, e = function () { var t = "es-ES", e = "numeric", n = "2-digit", a = "2-digit"; function i(a) { return new Date(a).toLocaleDateString(t, { year: e, month: n, day: n }) } function o(e) { return new Date(e).toLocaleTimeString(t, { hour: a, minute: a, hour12: !1 }) } return { formatDate: i, formatTime: o, formatDateTime: function (t) { return i(t) + " " + o(t) }, formatNumber: function (t, e) { return numeral(t).format("0,0." + nmd.utils.repeatString("0", e)) } } }(), n = { print: function () { window.print() }, getQueryStringObject: function () { var t, e = window.location.search.slice(1).split("&"), n = {}, a = e.length; if (window.location.search && a) for (var i = 0; i < a; i++)2 == (t = e[i].split("=")).length && (n[t[0]] = decodeURIComponent(t[1] || "")); return n }, reloadPage: function () { window.location = window.location }, isSmallScreen: function () { return window.matchMedia("(max-width: 767px)").matches }, disableF5Refresh: function () { $(document).on("keydown", (function (t) { return 116 != (t.which || t.keyCode) })) }, disableCopyAndPaste: function (t) { $(t || document).on("cut copy paste", (function (t) { return t.preventDefault(), !1 })) } }, a = { controls: function () { var e = { autopostback: "autopostback" }, a = { inputFile: "input-file", autopostbackHF: "autopostback-hf" }, i = { inputFiltering: "input-filtering" }, o = { regex: "regex" }, r = { target: "click-target" }, s = { stateContainer: "toggle-state-container" }, l = { class: { input: "custom-file-input", label: "custom-file-label" }, dataAttr: { browse: "browse", browseWithPrefix: "data-browse", selectedFile: "selected-file", selectedFileWithPrefix: "data-selected-file" } }; function c(t) { $(t || "." + l.class.input).each((function () { var t = u($(this)); t.text(t.data(l.dataAttr.selectedFile)) })) } function u(t) { return t.siblings("." + l.class.label) } function d(t, e, n) { var a = $.extend({}, { emptyOptionText: null, selectAllByDefault: !1, destroyAndRecreateSelectpicker: !1, itemsValueProperty: "Value", itemsTextProperty: "Text", itemsSelectedProperty: "Selected", itemsSelectedValue: null }, n), i = $("#" + t); i.empty(), null != a.emptyOptionText && i.append('<option value="">' + a.emptyOptionText + "</option>"), $.each(e, (function (t, e) { var n = e[a.itemsValueProperty], o = a.itemsSelectedValue === n || !0 === e[a.itemsSelectedProperty]; i.append('<option value="' + n + '" ' + (o ? 'selected="selected"' : "") + ">" + e[a.itemsTextProperty] + "</option>") })); var o = i.hasClass(F.class.selectpicker), r = i.hasClass(A.class.multiselect); (o || r) && (a.destroyAndRecreateSelectpicker ? (i.selectpicker("destroy"), r ? I("#" + t, i.data(A.dataAttr.options)) : i.selectpicker()) : (i.selectpicker("val", i.val()).selectpicker("refresh"), a.selectAllByDefault && r && i.selectpicker("selectAll"))), i.trigger("change") } function m(t, e, n) { var a = $.extend({}, { loadingEnabled: !1, loadingSelector: null, itemsAddedCallback: null, ajaxItemsProperty: "items", ajaxErrorProperty: "error", ajaxErrorDefaultMessage: "An error occurred." }, n), i = $("#" + t); i.empty(), a.loadingEnabled && w(a.loadingSelector), $.getJSON(e, (function (e) { var n = e[a.ajaxErrorProperty]; if (n) return alert(n), void d(t, [], a); d(t, e[a.ajaxItemsProperty], a), a.itemsAddedCallback && a.itemsAddedCallback($("#" + t)) })).fail((function (t) { alert(a.ajaxErrorDefaultMessage) })).always((function () { a.loadingEnabled && T(a.loadingSelector), i.trigger("change") })) } var f = { intervalId: "elapsed-time-interval-id", minutesReachedTriggered: "elapsed-time-minutes-reached-triggered" }, p = { checkBoxSelection: "checkbox-selection" }, g = { sortable: "table-sortable", sortedNone: "sorted-none", sortedAsc: "sorted-asc", sortedDesc: "sorted-desc" }, h = { sort: "sort", sortValue: "sort-value", sortAsc: "sort-asc", noSort: "no-sort" }, v = { tableOrderPost: "table-order-post" }, b = { order: "order" }; function x(t, e, n, a) { bootbox.alert({ message: '<div class="mt-3 text-center text-' + e + '"><i class="fa ' + n + ' fa-2x"></i>    <div class="mt-1">' + t + "</div></div>", buttons: {}, callback: a }) } function k(t, e, n, a) { var i = $.extend({}, { buttons: {} }, a); bootbox.confirm({ title: t, message: e, buttons: i.buttons, callback: n }) } var y = { modal: '<div class="modal fade" id="{0}" tabindex="-1" role="dialog" aria-labelledby="{0}Label"  aria-hidden="true"><div class="modal-dialog" role="document" ><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="{0}Label"></h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"></div></div></div></div>' }, C = { height: "350px" }, S = { iframe: "iframe", title: "iframe-title", modalSize: "iframe-modal-size", height: "iframe-height", onHidden: "iframe-onhidden" }; function w(t) { var e = { image: "", fontawesome: "fa fa-spinner fa-spin", size: 15 }; t ? $(t).LoadingOverlay("show", e) : $.LoadingOverlay("show", e) } function T(t) { t ? $(t).LoadingOverlay("hide") : $.LoadingOverlay("hide") } var F = { class: { selectpicker: "selectpicker" } }, A = { class: { multiselect: "multiselect" }, dataAttr: { options: "multiselect-opts" } }; function I(e, n) { var a = $.extend({}, { maxIndividualOptions: 3, allSelectedText: "All", countSelectedTextFormat: "{0} of {1}" }, n); $(e || "." + A.class.multiselect).selectpicker({ actionsBox: !0, selectedTextFormat: "count > " + a.maxIndividualOptions, countSelectedText: function (e, n) { return e == n ? a.allSelectedText : t.stringFormat(a.countSelectedTextFormat, e, n) } }).data(A.dataAttr.options, a) } var M = { selectpickerAjax: "selectpicker-ajax" }, V = { datepicker: "datepicker" }, P = { characterCounter: "character-counter" }, D = { numeric: "numeric", numericInteger: "numeric-integer" }, B = { numeric: "inputmask-numeric", integer: "inputmask-integer" }; function E(t, e, n, a) { $(t, e).inputmask(n, a) } var R = { togglePasswordVisibility: "toggle-password-visibility", toggleButton: "toggle-button", toggleButtonShow: "fa fa-eye", toggleButtonHide: "fa fa-eye-slash" }, O = { type: "type", password: "password", text: "text" }; return { clearControls: function (t) { var e = $(t); e.filter("input, select, textarea").val(""), e.filter(":radio,:checkbox").prop("checked", !1), c(t) }, initAutopostback: function () { $("." + e.autopostback).on("change", (function () { var t = $(this), e = t.closest("form"), n = t.data("autopostback-hf"); if (n) { var a = n.split("="); 2 == a.length && e.append('<input type="hidden" name="' + a[0] + '" value="' + a[1] + '" />') } e.submit() })), $(document).on("change", t.stringFormat("input.{0},select.{0},textarea.{0}", e.autopostback), (function () { $(this).closest("form").submit() })) }, showAlert: function (t, e, n) { $(t).show().html(e).attr("class", "alert alert-" + n) }, hideAlert: function (t) { $(t).hide().empty().attr("class", "") }, initPrintButton: function () { $(".btn-print").on("click", (function (t) { return t.preventDefault(), n.print(), !1 })) }, initScrollFocus: function () { var t = $(".scroll-focus"); t.length > 0 && $([document.documentElement, document.body]).animate({ scrollTop: t.first().offset().top - 30 }, 1e3) }, initInputFileButtons: function () { $(t.stringFormat("input[data-{0}],button[data-{0}]", a.inputFile)).each((function () { var t = $(this), e = t.data(a.inputFile), n = $("#" + e); if (n.hasClass("d-none") || n.addClass("d-none"), t.attr("name")) { var i = t.attr("name"), o = t.attr("value"); n.data(a.autopostbackHF, i + "=" + o) } })).on("click", (function (t) { t.preventDefault(); var e = $(this).data(a.inputFile); return $("#" + e).click(), !1 })) }, initInputFiltering: function (t, e) { var n = $.extend({}, { pattern: null }, e); function a(t, e) { return new RegExp("[" + (1 == e ? "^" : "") + (t.data(o.regex) || n.pattern) + "]", "g") } $(t || "." + i.inputFiltering).on("keypress", (function (t) { a($(this)).test(String.fromCharCode(t.keyCode)) || t.preventDefault() })).on("input", (function () { var t = $(this), e = a(t, !0); t.val(t.val().replace(e, "")) })) }, initClickControls: function () { $(nmd.utils.stringFormat("[data-{0}]", r.target)).on("click", (function (t) { t.preventDefault(); var e = $(t.target).data(r.target); return e && $(e).click(), !1 })) }, initToggleStateControls: function () { $(nmd.utils.stringFormat("[data-{0}]", s.stateContainer)).each((function () { var t = $(this), e = t.data(s.stateContainer); function n() { t.prop("disabled", !nmd.ui.forms.validateRequiredControls(e)) } n(), $("." + nmd.ui.forms.formsConstants.class.formControlRequired, e).on("change", (function () { n() })), $(e).on("reset", (function () { setTimeout((function () { n() }), 50) })) })) }, initBootstrapTooltips: function () { $('[data-toggle="tooltip"]').tooltip() }, initBootstrapCustomFileInput: function (t, e) { var n, a, i = $.extend({}, { browseText: "Buscar", selectedFileText: "..." }, e); $(t || "." + l.class.input).each((function () { var t = u($(this)); n = t.attr(l.dataAttr.browseWithPrefix) || i.browseText, a = t.attr(l.dataAttr.selectedFileWithPrefix) || i.selectedFileText, t.attr(l.dataAttr.browseWithPrefix, n).attr(l.dataAttr.selectedFileWithPrefix, a).text(a) })), bsCustomFileInput.init() }, clearBootstrapCustomFileInput: c, loadCombo: d, loadComboAjax: m, initComboCascadeAjax: function (t, e, n, a) { var i = "#" + e.replace(",", ",#"); function o() { var t = !1, e = $(i).map((function () { var e = $(this), n = e.hasClass(A.class.multiselect) ? e.val().join(",") : e.val(); return n || (t = !0), n })).get(); return t ? null : nmd.utils.stringFormat(n, e) } $(i).on("change", (function () { o() ? m(t, o(), a) : d(t, [], a) })) }, initComboCascadeJson: function (t, e, n, a) { var i = $.extend({}, { comboSelectedValue: null, parentComboSelectedValue: null }, a), o = function (t) { for (var e = { items: [] }, n = "string" == typeof t ? JSON.parse(t) : t, a = n.length, i = 0, o = 0; o < a; o++) { e.items.push(n[o]), e[n[o].Value] = {}, i = n[o].Items.length, e[n[o].Value] = []; for (var r = 0; r < i; r++)e[n[o].Value].push(n[o].Items[r]) } return e }(n); function r(n) { var a = [], r = $("#" + e).val(); r && (a = o[r]), d(t, a, $.extend({}, i, { itemsSelectedValue: n })) } d(e, o.items, { itemsSelectedValue: i.parentComboSelectedValue }), r(i.comboSelectedValue), $("#" + e).on("change", (function () { r() })) }, initElapsedTime: function (t, e, n) { var a = $.extend({}, { minutesReachedValue: null, minutesReachedCallback: null }, n), i = $("#" + t); if (0 !== i.length) { var o = moment(e), r = setInterval((function () { i = $("#" + t); var e = moment() - o, n = moment.duration(e), r = n.asMinutes(); if (i.text(r < 60 ? moment(e).format("mm:ss") : n.humanize()), a.minutesReachedValue && a.minutesReachedCallback && r > a.minutesReachedValue && !i.data(f.minutesReachedTriggered)) { try { a.minutesReachedCallback() } catch (t) { } i.data(f.minutesReachedTriggered, !0) } }), 800); i.data(f.intervalId, r) } }, stopElapsedTime: function (t) { var e = $("#" + t).data(f.intervalId); e && clearInterval(parseInt(e)) }, initTableCheckBoxSelection: function (t) { var e = "thead input[type=checkbox]", n = "tbody input[type=checkbox]", a = (t = t || "." + p.checkBoxSelection) + " " + e, i = t + " " + n; function o() { 0 != $(i).length && r($(a), 0 == $(i + ":not(:checked)").length) } function r(t, e) { t.prop("checked", e) } o(), $(t).on("change", e, (function (t) { r($(i), $(this).is(":checked")) })), $(t).on("change", n, (function (t) { o() })) }, initTableSorting: function (e) { e = e || "." + g.sortable; var n = t.stringFormat("th:not([data-{0}])", h.noSort); function a(e, n) { var a = e.find(t.stringFormat("td:nth-child({0})", n + 1)); return a.data(h.sortValue) || a.text() } function i(t, a) { var i = $(e + " " + n); i.removeClass(g.sortedNone).removeClass(g.sortedAsc).removeClass(g.sortedDesc), i.addClass(g.sortedNone), t && 1 == t.length && t.removeClass(g.sortedNone).addClass(a ? g.sortedAsc : g.sortedDesc).data(h.sortAsc, a ? "0" : "1") } i(), $(e).on("click", n, (function () { var t = $(this), n = $(e).find("tbody"), o = t.index(), r = "1" === (t.data(h.sortAsc) || "1"); n.find("tr").sort((function (t, e) { var n = a($(t), o).localeCompare(a($(e), o)); return r ? n : -n })).appendTo(n), i(t, r) })) }, initTableOrderPOST: function (e, n) { var a = $.extend({}, { orderInputName: "Order" }, n); e = e || "." + v.tableOrderPost; var i = t.stringFormat("th[data-{0}]", b.order); $(e).on("click", i, (function () { var t = $(this), e = t.closest("form"), n = t.data(b.order); e.append('<input type="hidden" name="' + a.orderInputName + '" value="' + n + '" />').submit() })) }, initModals: function (t) { var e = $.extend({}, { locale: "es", swapButtonOrder: !0 }, t); bootbox.setDefaults(e) }, showErrorModal: function (t, e) { x(t, "danger", "fa-times-circle", e) }, showSuccessModal: function (t, e) { x(t, "success", "fa-check-circle", e) }, showMessageModal: x, showConfirmModal: k, initIframeModalsLinks: function () { $(t.stringFormat("a[data-{0}]", S.iframe)).each((function () { var e = $(this), n = "mdIframe" + Math.floor(99999 * Math.random()), a = "#" + n; 0 == $(a).length && $("body").append(t.stringFormat(y.modal, n)), e.attr("data-toggle", "modal").attr("data-target", a), $(a).on("shown.bs.modal", (function () { var t = $(this), n = e.data(S.title) || "", a = e.data(S.modalSize); t.find(".modal-title").html(n), a && (a = "modal-" + a), t.find(".modal-dialog").attr("class", "modal-dialog " + a), t.find(".modal-body").empty().append('<iframe src="' + e.prop("href") + '" class="border-0 w-100" style="height: ' + (e.data(S.height) || C.height) + '"></iframe>') })).on("hidden.bs.modal", (function (t) { if ($(this).find(".modal-body").empty(), e.data(S.onHidden)) { for (var n = window, a = e.data(S.onHidden).split("."), i = a.pop(), o = 0; o < a.length; o++)n = n[a[o]]; return n[i].apply(n, [t, e]) } })) })) }, initSessionTimeoutCheck: function (t) { var e, n = $.extend({}, { timeoutInMin: 10, timeoutAlertInMin: 1, checkSessionUrl: "/Home/CheckSession", extendSessionUrl: "/Home/ExtendSession", sessionExpiredUrl: "/Home/SessionExpired", confirmModalTitle: "Session", confirmModalMessage: "Your session is expiring soon.", confirmModalExtendSessionButton: "Extend session" }, t), a = 6e4 * n.timeoutInMin, i = a - 6e4 * n.timeoutAlertInMin; function o() { e && clearTimeout(e), e = setTimeout((function () { $.getJSON(n.checkSessionUrl, (function (t) { !1 === t.authenticated ? window.location = n.sessionExpiredUrl : o() })) }), a) } o(), function t() { setTimeout((function () { k(n.confirmModalTitle, n.confirmModalMessage, (function (e) { e && $.post(n.extendSessionUrl, nmd.ui.forms.createDataWithAntiForgeryToken(), (function () { o(), t() })) }), { buttons: { confirm: { label: n.confirmModalExtendSessionButton, className: "btn-primary" }, cancel: { className: "d-none" } } }) }), i) }() }, showLoading: w, hideLoading: T, initMultiSelect: I, initSelectpickerAjax: function (t, e) { var n = $.extend({}, { minLength: 3, preserveSelected: !1 }, e); $(t || "." + M.selectpickerAjax).selectpicker({ liveSearch: !0 }).ajaxSelectPicker(n) }, initDatePicker: function (t, e) { var n = $.extend({}, { maxViewMode: 2, todayBtn: "linked", clearBtn: !0, autoclose: !0 }, e); $(t || "." + V.datepicker).datepicker(n).on("hide", (function (t) { t.stopPropagation() })) }, initCharacterCounter: function (t, e) { var n = $.extend({}, { renderTotal: !0, countNewLineChars: !1, counterWrapper: "small", counterCssClass: "float-right", counterFormat: "%1", counterExceededCssClass: "text-danger" }, e); $(t || "." + P.characterCounter).characterCounter(n) }, initNumeric: function (t, e) { var n = $.extend({}, { decimal: ".", decimalPlaces: -1 }, e); $(t || "." + D.numeric).numeric(n) }, initNumericInteger: function (t, e) { var n = $.extend({}, {}, e); $(t || "." + D.numericInteger).numeric({ decimal: !1, negative: n.negative }) }, initInputMaskNumeric: function (t, e, n) { var a = $.extend({}, { groupSeparator: ",", digits: 2 }, e); E(t || "." + B.numeric, n, "numeric", a) }, initInputMaskInteger: function (t, e, n) { var a = $.extend({}, { groupSeparator: "," }, e); E(t || "." + B.integer, n, "integer", a) }, getInputMaskValue: function (t, e) { return $(t, e).inputmask("unmaskedvalue") }, initPasswordVisibility: function (t) { function e(t, e) { var a = n(t); e ? (t.attr(O.type, O.text), a.find("i").removeClass(R.toggleButtonShow).addClass(R.toggleButtonHide)) : (t.attr(O.type, O.password), a.find("i").removeClass(R.toggleButtonHide).addClass(R.toggleButtonShow)) } function n(t) { return t.siblings("." + R.toggleButton) } $(t || "." + R.togglePasswordVisibility).each((function () { var t = $(this); t.css("border-right", "none").wrap('<div class="input-group flex-nowrap"></div>').after(nmd.utils.stringFormat('<div class="input-group-append {0}" style="cursor: pointer;"><span class="input-group-text" style="background: none;"><i></i><span></div>', R.toggleButton)), e(t, !1), n(t).on("click", (function () { var t = function (t) { return t.siblings("input." + R.togglePasswordVisibility) }($(this)); !function (t) { e(t, !function (t) { return t.attr(O.type) === O.text }(t)) }(t) })) })) } } }(), forms: function () { function t(t, e) { t.__RequestVerificationToken = $("input[name=__RequestVerificationToken]", e).val() } var e = { class: { formControlRequired: "form-control-required" } }; return { setAntiForgeryTokenToData: t, createDataWithAntiForgeryToken: function (e) { var n = {}; return t(n, e), n }, setAntiForgeryTokenToFormData: function (t, e) { t.append("__RequestVerificationToken", $("input[name=__RequestVerificationToken]", e).val()) }, disableEnterSubmit: function () { $(document).on("keydown", ":input:not(textarea)", (function (t) { return "Enter" != t.key })) }, initDisableOnSubmitButtons: function () { var t = ".disable-on-submit", e = "disabled-on-submit"; $(document).on("invalid-form.validate", "form", (function () { var n = $(this).find(t + " ." + e); setTimeout((function () { n.prop("disabled", !1).removeClass(e) }), 1) })), $(document).on("submit", "form", (function () { var n = $(this).find(t); setTimeout((function () { n.prop("disabled", !0).addClass(e) }), 0) })) }, setValidationSummaryVisibility: function () { 0 === $(".validation-summary-errors li:visible").length && $(".validation-summary-errors").hide() }, formsConstants: e, validateRequiredControls: function (t) { var n = !1; return $("." + e.class.formControlRequired, t).each((function () { $(this).val().trim() || (n = !0) })), !n } } }() }; return { utils: t, format: e, page: n, ui: a } }();